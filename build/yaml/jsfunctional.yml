# Variable 'python.version' was defined in the Variables tab
# Multi-job configuration must be converted to matrix strategy: https://docs.microsoft.com/en-us/azure/devops/pipelines/process/phases?view=azure-devops&tabs=yaml#multi-job-configuration
  # Container registry service connection established during pipeline creation

name: $(Build.BuildId)
trigger: none
pr: none

jobs:
- job: Build
  pool:
    vmImage: macos-10.14
  steps:
    clean: true
  - task: PowerShell@2
    displayName: Create .npmrc for npmjs feed - https://www.npmjs.com/
    inputs:
      targetType: inline
      script: >
        Set-Location -Path "$(SampleRootPath)"


        New-Item -Path . -Name ".npmrc" -ItemType "file" -Value "registry=https://registry.npmjs.com/"
  - task: Npm@1
    displayName: npm install Host Bot
    inputs:
      workingDir: Bots/JavaScript/Consumers/CodeFirst/SimpleHostBot
      verbose: false
      customFeed: b99a003e-8342-4082-978b-613db93df5b9
  - task: Npm@1
    displayName: npm pack HostBot
    inputs:
      command: custom
      workingDir: Bots/JavaScript/Consumers/CodeFirst/SimpleHostBot
      verbose: false
      customCommand: pack
  - task: Npm@1
    displayName: npm install CardSkillBot
    inputs:
      workingDir: Bots/JavaScript/Skills/CodeFirst/CardSkillBot
      verbose: false
  - task: Npm@1
    displayName: npm pack CardSkillBot
    inputs:
      command: custom
      workingDir: Bots/JavaScript/Skills/CodeFirst/CardSkillBot
      verbose: false
      customCommand: pack
  - task: Npm@1
    displayName: npm install EchoSkillBot
    inputs:
      workingDir: Bots/JavaScript/Skills/CodeFirst/EchoSkillBot
      verbose: false
  - task: Npm@1
    displayName: npm pack EchoSkillBot
    inputs:
      command: custom
      workingDir: Bots/JavaScript/Skills/CodeFirst/EchoSkillBot
      verbose: false
      customCommand: pack
  - task: Npm@1
    displayName: npm install EchoSkillBot-v3
    inputs:
      workingDir: Bots/JavaScript/Skills/CodeFirst/EchoSkillBot-v3
      verbose: false
  - task: Npm@1
    displayName: npm pack EchoSkillBot-v3
    inputs:
      command: custom
      workingDir: Bots/JavaScript/Skills/CodeFirst/EchoSkillBot-v3
      verbose: false
      customCommand: pack
  - task: Npm@1
    displayName: npm install MultiturnSkillBot
    inputs:
      workingDir: Bots/JavaScript/Skills/CodeFirst/MultiturnSkillBot
      verbose: false
  - task: Npm@1
    displayName: npm pack MultiturnSkillBot
    inputs:
      command: custom
      workingDir: Bots/JavaScript/Skills/CodeFirst/MultiturnSkillBot
      verbose: false
      customCommand: pack
  - task: Npm@1
    displayName: npm install ProactiveSkillBot
    inputs:
      workingDir: Bots/JavaScript/Skills/CodeFirst/ProactiveSkillBot
      verbose: false
  - task: Npm@1
    displayName: npm pack ProactiveSkillBot
    inputs:
      command: custom
      workingDir: Bots/JavaScript/Skills/CodeFirst/ProactiveSkillBot
      verbose: false
      customCommand: pack
